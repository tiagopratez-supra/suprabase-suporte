<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <title>Suporte SupraMAIS - Replica√ß√£o de Dados</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<script src="js/auth.js"></script>
<script>requireAuth();</script>

<div class="app">

<aside class="sidebar">
    <div class="brand">
      <img src="img/logo.png" alt="SupraMAIS">
      <div class="title">
        <strong>Base do Suporte</strong>
        <span>Procedimentos e checklists</span>
      </div>
    </div>

    <div class="nav">
      <a class="" href="home.html">üè† Home</a>

      <div class="nav-group">
        <h3>Banco de Dados</h3>
        <a class="" href="script-versao.html">üìÑ Script de Vers√£o</a>
        <a class="" href="profile-sql.html">üß™ SQL Server Profile</a>
      </div>

      <div class="nav-group">
        <h3>Configura√ß√£o de Par√¢metros</h3>
        <a class="active" href="replicacao.html">üîÅ Replica√ß√£o de Dados</a>
        <a class="" href="configuracao-email.html">üìß Configura√ß√£o de E-mail</a>
        <a class="" href="backup-agente.html">üóÑÔ∏è Backup - Agente SupraMAIS</a>
      </div>
    </div>
  </aside>

  <section class="content">

    <div class="topbar">
      <h1>üîÅ Replica√ß√£o de Dados</h1>

      <div class="topbar-actions">
        <span class="badge">SupraMAIS</span>
        <button class="btn-logout" onclick="logout()">Sair</button>
      </div>
    </div>

    <div class="main">

      <div class="section">
        <h2>Conceito</h2>
        <ul>
          <li><strong>O que √©?</strong> √â uma configura√ß√£o para que algumas informa√ß√µes de tabelas sejam clonadas entre bancos de dados.</li>
          <li><strong>Quem cria?</strong> √â criado no ato da instala√ß√£o de um banco adicional do cliente, caso ele desejar.</li>
          <li><strong>Onde habilita?</strong> Ferramentas &gt; configura√ß√£o de par√¢metros &gt; aba sistema (somente habilitado pela senha m√°ster).</li>
          <li><strong>Onde ficam?</strong> Quando habilitado: Ferramentas &gt; configura√ß√£o de par√¢metros &gt; aba integra√ß√µes &gt; replica√ß√£o.</li>
        </ul>

        <h3>Como funciona</h3>
        <ol>
          <li><strong>Bancos de dados</strong>: que replicam os dados entre si (a sigla √© exibida em relat√≥rios/telas multi-bancos).</li>
          <li><strong>Tabelas principais</strong>: que ser√£o replicadas (ex.: Produto, cliente/fornecedor, tipos de pedido, tipos de nota, etc.).</li>
          <li><strong>Tabelas agregadas</strong>: tabelas necess√°rias para um cadastro sem janela espec√≠fica (ex.: Contato, Endere√ßo, unidade de convers√£o, etc.).</li>
          <li><strong>Campos exce√ß√£o</strong>: campos que n√£o podem replicar (por solicita√ß√£o do cliente ou necessidade do SupraMAIS).</li>
        </ol>

        <p><strong>Observa√ß√£o:</strong> sempre que configurado, 3 exce√ß√µes s√£o obrigat√≥rias para todo cliente: Produto (Quantidade estoque), Vendedor (Imagem assinatura) e Cliente (Cobran√ßa).</p>

        <p><img src="img/doc/replicacao-tela.png" alt="Tela de replica√ß√£o (Bancos, Tabelas, Agregadas e Exce√ß√µes)"></p>
      </div>

      <div class="section">
        <h2>Exemplos de erros</h2>

        <p><strong>Aten√ß√£o:</strong> nem sempre colocar campo como exce√ß√£o √© solu√ß√£o para erro de replica√ß√£o. Cada caso deve ser avaliado individualmente ‚Äî nunca utilizar sem an√°lise detalhada.</p>

        <h3>Erro: Nome de coluna inv√°lido</h3>
        <p><strong>Erro:</strong> ‚ÄúNome de coluna <code>'catpro_codigo'</code> inv√°lido Banco: SGC Tabela: produto‚Äù</p>
        <p><strong>Poss√≠vel causa:</strong> o campo n√£o foi criado em algum dos bancos que replicam (script n√£o executado/cliente n√£o abriu um banco, ou banco n√£o atualizado ‚Äî comum em bancos antigos que continuam na replica√ß√£o).</p>
        <p><strong>Solu√ß√£o:</strong> garantir que todos os bancos est√£o atualizados, conferir se o campo existe na tabela produto em todos os bancos; abrir o banco indicado no erro para for√ßar a execu√ß√£o do script respons√°vel.</p>

        <h3>Erro: conflito de chave estrangeira (FOREIGN KEY)</h3>
        <p><strong>Erro:</strong> ‚ÄúReplica√ß√£o cancelada. N√£o foi poss√≠vel replicar os dados. Banco: SGC2 Tabela: produto ... INSERT conflitou com a restri√ß√£o do FOREIGN KEY <code>FK_principio_ativo</code> ... tabela <code>PRINCIPIO_ATIVO</code>‚Äù</p>
        <p><strong>Poss√≠vel causa:</strong> o <em>princ√≠pio ativo</em> vinculado ao produto n√£o existia no banco de destino.</p>
        <p><strong>Solu√ß√£o:</strong> verificar se o princ√≠pio ativo existe no banco de destino; se n√£o existir, corrigir/cadastrar e ent√£o ajustar a replica√ß√£o do princ√≠pio ativo.</p>
      </div>
    </div>
  </section>

</div>
</body>
</html>
